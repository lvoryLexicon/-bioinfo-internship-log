è¿™æ˜¯ä»å‚è€ƒåŸºå› ç»„å‡†å¤‡åˆ°åºåˆ—æ¯”å¯¹æ•°æ®å¤„ç†å†åˆ°å¯è§†åŒ–çš„å…¨è¿‡ç¨‹çš„æ•™ç¨‹ï¼ŒæŒ‰ç…§æ ‡å‡†äºŒä»£æµ‹åºï¼ˆNGSï¼‰æµç¨‹é€»è¾‘ï¼Œæ•™ç¨‹ä¼šè¯´æ˜æ¯ä¸€æ­¥çš„ä½œç”¨ä¸æˆæœã€‚

---

 âœ… 1. ç›®æ ‡ç†è§£ä¸å·¥ä½œæ–¹å‘æ˜ç¡®

æ˜ç¡®æœ¬é¡¹ç›®çš„æ ¸å¿ƒç›®æ ‡ï¼š

> åˆ©ç”¨ç—…äººæ ·æœ¬ä¸­çš„ DNA æµ‹åºæ•°æ®ï¼Œé€šè¿‡æ¯”å¯¹äººç±»å‚è€ƒåŸºå› ç»„ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨ç—…æ¯’åºåˆ—æ’å…¥ï¼ˆä¾‹å¦‚ TTMVï¼‰ï¼Œå¹¶å®šä½å…¶ä½ç½®ã€‚

---

 âœ… 2. å‚è€ƒåŸºå› ç»„ä¸‹è½½ä¸å®šä½

æ‰¾åˆ°å¯ç”¨çš„äººç±»åŸºå› ç»„æ–‡ä»¶ï¼š
 ä¾‹å¦‚ï¼š
 æ–‡ä»¶åï¼šGRCh38.primary_assembly.genome.fa
 ä½ç½®ï¼š/public/DATA/common_data/genome/hg38/

ğŸ“Œ ä½œç”¨ï¼šè¿™æ˜¯ä¸€ä»½å›½é™…æ ‡å‡†çš„äººç±»åŸºå› ç»„åºåˆ—ï¼Œä½œä¸ºæ¯”å¯¹çš„â€œå‚ç…§â€ã€‚

---

 âœ… 3. å¤åˆ¶å‚è€ƒåŸºå› ç»„åˆ°ä¸ªäººå·¥ä½œç›®å½•

å°† GRCh38.primary_assembly.genome.fa å¤åˆ¶åˆ°ä½ è‡ªå·±çš„å·¥ä½œç›®å½•ä¸­ï¼š

bash
cp /public/DATA/common_data/genome/hg38/GRCh38.primary_assembly.genome.fa ~/genome/


ğŸ“‚ ä½ çš„å·¥ä½œç›®å½•è·¯å¾„ä¸ºï¼š/public/home/shenyz/genome/

---

 âœ… 4. ä¸ºäººç±»åŸºå› ç»„æ„å»º BWA ç´¢å¼•

ä½¿ç”¨ bwa index ä¸ºå‚è€ƒåŸºå› ç»„æ„å»ºç´¢å¼•ï¼š

bash
bwa index GRCh38.primary_assembly.genome.fa


ğŸ”§ è¾“å‡ºæ–‡ä»¶åŒ…æ‹¬ï¼š

 .amb, .ann, .bwt, .pac, .sa

ğŸ“Œ ä½œç”¨ï¼šBWA ç´¢å¼•èƒ½è®©åç»­æ¯”å¯¹è¿…é€Ÿå®šä½å‚è€ƒåºåˆ—ï¼Œæé«˜æ•ˆç‡ã€‚

---

 âœ… 5. åŸå§‹æµ‹åºæ•°æ®ï¼ˆæ ·æœ¬ FASTQï¼‰å‡†å¤‡

å·²ç»å‡†å¤‡å¥½çš„æˆå¯¹çš„ clean FASTQ æ–‡ä»¶ï¼š

bash
zzq_1.clean.fq
zzq_2.clean.fq


âœ… è¿™é€šå¸¸æ¥è‡ªäºä¸‹æ¸¸è´¨æ§å·¥å…·çš„è¾“å‡ºï¼Œå¦‚ï¼šTrimmomaticã€fastp

---

 âœ… 6. æŒæ¡ Seqkit å¹¶å®Œæˆè´¨æ§ç»Ÿè®¡

å®‰è£… seqkit å¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡ŒåŸºæœ¬è´¨é‡ç»Ÿè®¡ï¼š

bash
seqkit stats -j 12 zzq_1.clean.fq zzq_2.clean.fq


ğŸ“Š å¾—åˆ°çš„ä¿¡æ¯åŒ…æ‹¬ï¼š

 æ€»åºåˆ—æ•°
 æ€»ç¢±åŸºæ•°
 N50ã€GC å«é‡ã€æœ€å¤§/æœ€å°åºåˆ—é•¿åº¦ç­‰

ğŸ“Œ ä½œç”¨ï¼šç¡®è®¤æ•°æ®è§„æ¨¡ä¸è´¨é‡ï¼Œä¸ºæ¯”å¯¹å’Œåç»­åˆ†ææä¾›åˆ¤æ–­ä¾æ®ã€‚

---

 âœ… 7. æŒæ¡äº†å¤šçº¿ç¨‹æ¯”å¯¹å‘½ä»¤çš„å†™æ³•

å­¦ä¼šå¦‚ä½•ä½¿ç”¨ bwa mem å¤šçº¿ç¨‹æ¯”å¯¹ï¼š

bash
bwa mem -t 12 GRCh38.primary_assembly.genome.fa zzq_1.clean.fq zzq_2.clean.fq > zzq.sam 2> bwa_mem.log


ğŸ“Œ ä½œç”¨ï¼šå°†æ ·æœ¬ DNA åºåˆ—ä¸å‚è€ƒåŸºå› ç»„æ¯”å¯¹ï¼Œè¾“å‡º .sam æ ¼å¼æ–‡ä»¶ä»¥ä¾›ä¸‹æ¸¸å¤„ç†ã€‚

---

 âœ… 8. å‘ç°æµç¨‹é—®é¢˜å¹¶åŠæ—¶ä¿®æ­£æ€è·¯

ä¾‹å¦‚æ›´ä¼˜è§£ï¼š

> åº”è¯¥å°†ç—…æ¯’åŸºå› ç»„ï¼ˆå¦‚ TTMVï¼‰å’Œäººç±»å‚è€ƒåŸºå› ç»„åˆå¹¶ï¼Œå†æ„å»ºç´¢å¼•å¹¶æ¯”å¯¹ã€‚è¿™æ ·æ‰èƒ½è®© BWA è¯†åˆ«ç—…æ¯’æ’å…¥åºåˆ—ã€‚

å·²ç»å…·å¤‡å¦‚ä¸‹æ¡ä»¶ï¼š

 TTMV.fa ç—…æ¯’åºåˆ—å·²åœ¨å·¥ä½œç›®å½•ä¸­
 åˆå¹¶ fasta çš„åšæ³•ï¼š

bash
cat GRCh38.primary_assembly.genome.fa TTMV.fa > human_virus.fa


 å·²å‡†å¤‡é‡æ–°ç´¢å¼•å¹¶æ¯”å¯¹

---

 ğŸ§© åˆ°ç›®å‰ä¸ºæ­¢çš„å…³é”®æˆæœæ±‡æ€»

| æ¨¡å—      | å®Œæˆæƒ…å†µ | è¯´æ˜                          |
| ------- | ---- | --------------------------- |
| é¡¹ç›®ç›®æ ‡ç†è§£  | âœ…    | æ˜ç¡®ç›®æ ‡æ˜¯æ£€æµ‹ç—…æ¯’æ’å…¥ç‰‡æ®µ               |
| ç¯å¢ƒå‡†å¤‡    | âœ…    | å®‰è£…äº† BWAã€Seqkitï¼ŒæŒæ¡äº† Linux æ“ä½œ |
| åŸºå› ç»„æ–‡ä»¶å‡†å¤‡ | âœ…    | ä¸‹è½½å¹¶ç´¢å¼•äº† GRCh38               |
| æµ‹åºæ•°æ®å‡†å¤‡  | âœ…    | clean FASTQ æ–‡ä»¶å°±ç»ª            |
| æ•°æ®ç»Ÿè®¡ä¸è´¨æ§ | âœ…    | ä½¿ç”¨ seqkit è·å–è´¨é‡æŒ‡æ ‡            |
| æ¯”å¯¹æµç¨‹æŒæ¡  | âœ…    | ç†Ÿæ‚‰ bwa mem å’Œåå°è¿è¡Œï¼ˆnohupï¼‰   |
| æ–¹æ³•æ›´æ–°    | âœ…    | æ˜ç™½éœ€è¦åˆå¹¶äººç±»+ç—…æ¯’åºåˆ—å‚è€ƒåŸºå› ç»„          |

---

 âœ… ä¸‹ä¸€æ­¥æ¨èæ“ä½œï¼ˆæŒ‰é¡ºåºï¼‰

1. åˆå¹¶å‚è€ƒåŸºå› ç»„å¹¶ç´¢å¼•

bash
cd ~/genome
cat GRCh38.primary_assembly.genome.fa ~/TTMV.fa > human_virus.fa
bwa index human_virus.fa


2. é‡æ–°è¿è¡Œæ¯”å¯¹ä»»åŠ¡

bash
nohup bwa mem -t 12 human_virus.fa ~/zzq_1.clean.fq ~/zzq_2.clean.fq > zzq_hv.sam 2> bwa_hv.log &


3. åå¤„ç†ï¼šè½¬æ¢ä¸º BAMã€æ’åºã€å»ºç´¢å¼•

bash
samtools view -Sb zzq_hv.sam > zzq_hv.bam
samtools sort zzq_hv.bam -o zzq_hv.sorted.bam
samtools index zzq_hv.sorted.bam


4. å¯è§†åŒ–æ¯”å¯¹ç»“æœï¼šåœ¨ IGV ä¸­åŠ è½½ human_virus.fa å’Œ zzq_hv.sorted.bam
